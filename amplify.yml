version: 1
backend:
  phases:
    preBuild:
      commands:
        - echo "AWS Amplify Backend Build Started"
        - echo "Installing dependencies..."
        - npm ci --only=production
        - echo "Dependencies installed"
    build:
      commands:
        - echo "Starting backend build process..."
        - npm run build
        - echo "Verifying application structure..."
        - ls -la src/
        - echo "Checking package.json scripts..."
        - npm run --silent
    postBuild:
      commands:
        - echo "Backend build completed successfully"
        - echo "Application ready for deployment"
        - echo "Build summary:"
        - echo "  - Node.js version: $(node --version)"
        - echo "  - NPM version: $(npm --version)"
        - echo "  - Environment: $NODE_ENV"
frontend:
  phases:
    preBuild:
      commands:
        - echo "Backend-only deployment - no frontend build required"
    build:
      commands:
        - echo "Skipping frontend build"
  artifacts:
    baseDirectory: /
    files:
      - "**/*"
    name: payment-api-backend
  cache:
    paths:
      - node_modules/**/*
      - ~/.npm/**/* 